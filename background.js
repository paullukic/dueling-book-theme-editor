/*! For license information please see background.js.LICENSE.txt */
(()=>{function t(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function u(t,o,c,i){var u=o&&o.prototype instanceof s?o:s,l=Object.create(u.prototype);return e(l,"_invoke",function(t,e,o){var c,i,u,s=0,l=o||[],f=!1,d={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(t,e){return c=t,i=0,u=n,d.n=e,a}};function p(t,e){for(i=t,u=e,r=0;!f&&s&&!o&&r<l.length;r++){var o,c=l[r],p=d.p,b=c[2];t>3?(o=b===e)&&(u=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=n):c[0]<=p&&((o=t<2&&p<c[1])?(i=0,d.v=e,d.n=c[1]):p<b&&(o=t<3||c[0]>e||e>b)&&(c[4]=t,c[5]=e,d.n=b,i=0))}if(o||t>1)return a;throw f=!0,e}return function(o,l,b){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,b),i=l,u=b;(r=i<2?n:u)||!f;){c||(i?i<3?(i>1&&(d.n=-1),p(i,u)):d.n=u:d.v=u);try{if(s=2,c){if(i||(o="next"),r=c[o]){if(!(r=r.call(c,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,i<2&&(i=0)}else 1===i&&(r=c.return)&&r.call(c),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=n}else if((r=(f=d.n<0)?u:t.call(e,d))!==a)break}catch(t){c=n,i=1,u=t}finally{s=1}}return{value:r,done:f}}}(t,c,i),!0),l}var a={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var d=[][c]?r(r([][c]())):(e(r={},c,function(){return this}),r),p=f.prototype=s.prototype=Object.create(d);function b(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,i,"GeneratorFunction")),t.prototype=Object.create(p),t}return l.prototype=f,e(p,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,i,"GeneratorFunction"),e(p),e(p,i,"Generator"),e(p,c,function(){return this}),e(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:u,m:b}})()}function e(t,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}e=function(t,n,r,o){function i(n,r){e(t,n,function(t){return this._invoke(n,r,t)})}n?c?c(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r:(i("next",0),i("throw",1),i("return",2))},e(t,n,r,o)}function n(t,e,n,r,o,c,i){try{var u=t[c](i),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise(function(o,c){var i=t.apply(e,r);function u(t){n(i,o,c,u,a,"next",t)}function a(t){n(i,o,c,u,a,"throw",t)}u(void 0)})}}chrome.tabs.onUpdated.addListener(function(){var e=r(t().m(function e(n,r,o){var c;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:if("complete"!==r.status||!o.url||!o.url.includes("duelingbook.com")){t.n=6;break}return t.p=1,t.n=2,chrome.scripting.executeScript({target:{tabId:n},func:function(){return!!document.getElementById("duelingbook-theme-editor")}});case 2:if(t.v[0].result){t.n=4;break}return t.n=3,chrome.scripting.executeScript({target:{tabId:n},files:["contentScript.js"]});case 3:console.log("DuelingBook Theme Editor injected automatically");case 4:t.n=6;break;case 5:t.p=5,c=t.v,console.error("Failed to inject content script:",c);case 6:return t.a(2)}},e,null,[[1,5]])}));return function(t,n,r){return e.apply(this,arguments)}}()),chrome.tabs.onActivated.addListener(function(){var e=r(t().m(function e(n){var r,o;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,chrome.tabs.get(n.tabId);case 1:if(!(r=t.v).url||!r.url.includes("duelingbook.com")){t.n=4;break}return t.n=2,chrome.scripting.executeScript({target:{tabId:n.tabId},func:function(){return!!document.getElementById("duelingbook-theme-editor")}});case 2:if(t.v[0].result){t.n=4;break}return t.n=3,chrome.scripting.executeScript({target:{tabId:n.tabId},files:["contentScript.js"]});case 3:console.log("DuelingBook Theme Editor injected on tab activation");case 4:t.n=6;break;case 5:t.p=5,o=t.v,console.error("Failed to inject content script on tab activation:",o);case 6:return t.a(2)}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()),chrome.action.onClicked.addListener(function(){var e=r(t().m(function e(n){var r;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!n.url||!n.url.includes("duelingbook.com")){t.n=5;break}return t.p=1,t.n=2,chrome.scripting.executeScript({target:{tabId:n.id},func:function(){return!!document.getElementById("duelingbook-theme-editor")}});case 2:if(t.v[0].result){t.n=3;break}return t.n=3,chrome.scripting.executeScript({target:{tabId:n.id},files:["contentScript.js"]});case 3:chrome.tabs.sendMessage(n.id,{action:"toggleThemeEditor"}),t.n=5;break;case 4:t.p=4,r=t.v,console.error("Failed to toggle theme editor:",r);case 5:return t.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}())})();